SELECT
    ROUND(A.PMAP-(A.PMAP*0.1), 0) AS PMAP10,
    A.*
FROM KOPO_PROMOTION A
    
    
    
SELECT A.*
FROM KOPO_PROMOTION A




SELECT A.*
FROM KOPO_PROMOTION A
WHERE 1=1
AND MAP_PRICE IS NULL


SELECT A.*,
        A.PMAP/A.MAP_PRICE AS PRO_PERCENT
FROM KOPO_PROMOTION A
WHERE 1=1
AND MAP_PRICE IS NOT NULL

SELECT A.*,
CASE WHEN A.MAP_PRICE = 0 THEN 0
ELSE 0 END AS TEST
FROM KOPO_PROMOTION A
WHERE 1=1



SELECT DISTINCT ACCOUNTNAME 
FROM KOPO_CHANNEL_RESULT
WHERE 1=1 
AND ACCOUNTNAME LIKE '%COS%'

SELECT * FROM TABS
WHERE 1=1
AND TABLE_NAME LIKE '%JOIN%'


SELECT * FROM KOPO_PRODUCT_VOLUME
WHERE 1=1
AND PRODUCTGROUP = 'ST0001'
AND YEARWEEK BETWEEN '201544' AND '201555'

SELECT * FROM KOPO_PRODUCT_VOLUME
WHERE 1=1
AND YEARWEEK BETWEEN &startdate AND &enddata

SELECT * FROM KOPO_PROMOTION



SELECT * FROM KOPO_PROMOTION
WHERE 1=1
AND TARGETWEEK BETWEEN &startdate AND &enddata


---- 정렬하기 ORDER BY

select * from kopo_product_volume
where 1=1
order by yearweek ASC, productgroup DESC



-- 기본키를 기준으로 정렬하면 데이터의 흐름을 볼 수 있다. DESC는 내림차순. ASC 오름차순

---- 집합 연산자. UNION(중복은 제거), UNION ALL(중복된 값 포함)

---- 테이블 두개의 컬럼이 같아야 한다.

SELECT * FROM TB1
UNION
SELECT * FROM TB2 


----- 전체 선택 후 CTRL E 하면 코스트가 보인다. 중복 체크를 하면 코스트가 올라감.
SELECT * FROM KOPO_PRODUCT_VOLUME
UNION 
SELECT * FROM KOPO_PRODUCT_VOLUME



SELECT *
FROM KOPO_CHANNEL_RESULT
WHERE 1=1
AND ITEM IN (SELECT DISTINCT ITEM FROM ITEM_LIST)


SELECT * FROM ITEM_LIST



-- 함수 (단일행 함수, 복수행 함수)

--- 문자함수

---- LOWER, UPPER
SELECT LOWER(ITEM)
FROM KOPO_CHANNEL_RESULT


SELECT
    UPPER(PRODUCT) AS CASE1,
    LOWER(PRODUCT) AS CASE2
    FROM KOPO_CHANNEL_SEASONALITY_NEW


SELECT LOWER('ABCD') FROM DUAL
 
---- SUBSTRING
SELECT SUBSTR(CUSTOMERCODE,4) FROM
KOPO_CUSTOMERDATA

---- INSTR 찾고 싶은 문자 _ 가 어디에 위치하냐
SELECT INSTR('AB_CD', '_') FROM DUAL

---- LPAD RPAD

SELECT * FROM CUSTOMERDATA


---- LPAD 사용해야 풀리는 문제,

select * from SORT_EXAMPLE
where 1=1
order by WEEK DESC


---- 별칭 꼭 달아주기
SELECT A.WEEK
FROM SORT_EXAMPLE A
ORDER BY LPAD(A.WEEK,2,'0') DESC





----- 0이라고하는 패딩을 10자리까지 붙히겟다
SELECT RPAD(CUSTID,10,'0') FROM CUSTOMERDATA

---- TRIM RTRIM
---- 공백 삭제.
SELECT length(trim(' haiteam ')) from dual

---- 왼쪽에 있는 별표 제거
SELECT LTRIM('*LOVE*','*') FROM DUAL

SELECT RTRIM('*LOVE*','*') FROM DUAL

---- REPLACE
SELECT REPLACE('KOPO_HAITEAM','KOPO','COCO') FROM DUAL


---- CONCAT
----- REGIONID에 언더바 붙이고 그 뒤에 프로덕트 붙여서 다시 컨캣. 컨캣 콜로 완성
SELECT CONCAT(CONCAT(REGIONID, '_'), PRODUCT) AS CONCAT_COL,
REGIONID
FROM KOPO_CHANNEL_SEASONALITY_NEW

---- 컬럼 값 추출하기

SELECT PRODUCT,
        SUBSTR(PRODUCT,0,4)
FROM KOPO_CHANNEL_SEASONALITY_NEW


---- LPAD

SELECT LPAD(PRODUCT, 10, '0') AS LPAD_TEST
FROM KOPO_CHANNEL_SEASONALITY_NEW

SELECT LPAD(CUSTOMERCODE, 12, '*') AS LPAD_TEST
FROM KOPO_CUSTOMERDATA


SELECT
    REPLACE(REGIONID,'A','SEC_') AS REGIONID_
    FROM KOPO_CHANNEL_SEASONALITY_NEW
    


SELECT REPLACE((LPAD(CUSTOMERCODE, 10, '0')), SUBSTR(LPAD(CUSTOMERCODE, 10, '0'),7,10), '****') AS LPAD_TEST
FROM KOPO_CUSTOMERDATA


SELECT REPLACE(LPAD(CUSTOMERCODE, 10, '0'),SUBSTR(LPAD(CUSTOMERCODE, 10, '0'),7,10), '****' ) AS LPAD_TEST
FROM KOPO_CUSTOMERDATA


SELECT REPLACE('KOPO_HAITEAM','KOPO','COCO') FROM DUAL






SELECT REPLACE(LPAD(CUSTOMERCODE, 10, '0'), SUBSTR(LPAD(CUSTOMERCODE, 10, '0'),7, 10), '****')
FROM KOPO_CUSTOMERDATA



SELECT ' AO1 ' AS REGIONID_ORG,
    A.*,
   
 FROM KOPO_PRODUCT_VOLUME A
WHERE 1=1
AND  A.REGIONID_ORG=B.REGIONID


SELECT '  STR '  AS ID1, 
'STR' AS ID2
STR = STR AS 
FROM DUAL




---- LPAD 사용해야 풀리는 문제,

select * from SORT_EXAMPLE
where 1=1
order by WEEK DESC


 ----- LPAD도 정렬도 가능하다.
SELECT LPAD(WEEK,2,0) AS WEEK
FROM SORT_EXAMPLE


















































